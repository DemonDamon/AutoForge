# AutoForge WebUI 产品需求文档 (PRD)

> 版本: 1.0
> 
> 日期: 2025-06-27

## 1. 项目概述

### 1.1. 项目目标

开发一个直观、易用的Gradio Web界面，以简化与AutoForge核心功能的交互。用户应能通过该界面轻松完成从需求输入、模型搜索、实验设计到结果分析的全过程，无需编写任何代码。其核心是提供一个"一键式"的AI解决方案发现体验。

### 1.2. 目标用户

*   **AI产品经理/项目经理**: 需要快速验证AI方案的可行性，评估技术选型。
*   **AI研究员/工程师**: 希望简化繁琐的前期调研工作，快速找到相关的模型和论文。
*   **学生/AI爱好者**: 学习和探索不同AI任务的最佳实践和解决方案。

### 1.3. 参考功能

WebUI的核心功能将围绕 `examples/quick_start.py` 中展示的 `AutoForgeAgent` 工作流进行构建，主要包括：

*   **LLM客户端配置**: 支持选择不同的大模型服务（如百炼、DeepSeek、OpenAI等）。
*   **多样化需求输入**: 支持通过手动文本描述或上传需求文档两种方式输入。
*   **全流程自动化分析**: 一键运行完整的分析流程 (`run_full_pipeline`)。
*   **优雅的结果展示**: 参考 `outputs/video_title_normalization` 的目录结构，清晰、美观地展示多阶段的分析结果。

## 2. 功能需求

### 2.1. 主界面布局

采用响应式的多列布局，在桌面端提供最佳体验。

*   **左侧边栏 (或顶部Accordion)**: **配置与输入区**。用于设置LLM、输入需求和配置高级选项。
*   **右侧主区域**: **状态与结果展示区**。用于显示实时日志、运行状态以及最终生成的分析报告。

### 2.2. 配置与输入区 (左侧)

#### 2.2.1. LLM 配置

*   **LLM提供商**: 下拉菜单选择，支持 `Bailian`, `DeepSeek`, `OpenAI`。
*   **API Key**: 密码输入框，用于输入所选提供商的API Key。输入后自动从环境变量或配置文件加载。
*   **模型选择**: 下拉菜单，根据选择的提供商动态加载可用模型列表（例如 `qwen-plus-latest`, `deepseek-reasoner`）。
*   **连接测试**: 一个"测试连接"按钮，点击后验证API Key和网络的有效性，并在按钮旁显示"✅ 连接成功"或"❌ 连接失败"的状态。

#### 2.2.2. 需求输入

使用Tab组件进行切换，提供两种输入模式：

1.  **手动描述**:
    *   提供一个大的文本输入框 (`gr.Textbox`)，允许用户详细描述他们的需求。
    *   可以提供一个模板或引导性问题，帮助用户构建更有效的需求描述。

2.  **文档分析**:
    *   提供一个文件上传组件 (`gr.File`)，允许用户上传单个或多个需求文档（如 `.txt`, `.md`, `.pdf`, `.docx`）。
    *   未来可支持输入文档目录的路径。

#### 2.2.3. 高级选项

默认折叠，可展开进行配置：

*   **Top K 模型搜索**: 数字输入或滑块，用于指定模型搜索阶段返回的模型数量（例如，默认30）。
*   **跳过实验执行**: 复选框，对应 `skip_experiment_execution` 参数，默认为勾选状态。
*   **输出目录**: 文本输入框，允许用户自定义本次分析结果的保存目录名，默认为基于当前时间戳的目录。

#### 2.2.4. 控制按钮

*   **开始分析**: 主操作按钮，点击后锁定所有配置项，并开始执行分析流程。
*   **清除/重置**: 将所有配置和输入恢复到初始状态。

### 2.3. 状态与结果展示区 (右侧)

#### 2.3.1. 实时状态

*   **状态指示器**: 一个文本区域，实时显示当前Agent的状态，如 `Initializing...`, `Analyzing Requirements...`, `Searching Models...`, `Analysis Complete!`。
*   **日志输出 (可选)**: 一个可折叠的文本框，用于显示详细的`loguru`日志，方便调试。

#### 2.3.2. 结果展示

当分析完成后，结果区将以Tab页的形式展示报告，每个Tab对应输出目录中的一个核心结果文件。

参考 `outputs/video_title_normalization` 的结构，Tab页应至少包括：

*   **[总览] 需求分析 (Requirement Analysis)**:
    *   展示 `requirement_analysis/requirement_analysis.md` 的内容。
    *   使用 `gr.Markdown` 组件渲染，以获得最佳的可读性（包括标题、列表、表格等）。

*   **[核心] 模型搜索 (Model Search)**:
    *   展示 `model_search/model_search_report.md` 的内容。
    *   表格内容需要被优雅地渲染。模型名称可以附带HuggingFace或ModelScope的链接。

*   **HuggingFace模型详情**:
    *   展示 `hf_models/hf_models_report.md` 的内容。
    *   同样使用Markdown组件进行渲染。

*   **实验设计 (Experiment Design)**:
    *   如果未跳过实验，则展示对应的实验设计报告。

*   **原始文件**:
    *   提供一个可下载的链接，将整个输出目录打包为 `.zip` 文件供用户下载。

## 3. 非功能性需求

*   **UI/UX**: 界面应简洁、美观，引导清晰。组件布局合理，避免信息过载。
*   **响应性**: Gradio应用应具备基本的响应式设计，在不同尺寸的屏幕上都能正常使用。
*   **可维护性**: 代码结构清晰，将UI代码 (`app.py`) 与后端逻辑 (`AutoForgeAgent` 的调用) 分离。

## 4. 技术栈

*   **Web框架**: Gradio
*   **后端逻辑**: AutoForge

## 5. 里程碑

### Milestone 1: 核心功能实现 (MVP) - ✅ 已完成

1.  [x] **搭建基本UI框架**: 已实现左右分栏布局。
2.  [x] **实现LLM配置与连接测试**: 已完成2.2.1节中所有功能，包括动态模型选择。
3.  [x] **实现手动描述输入与分析**: 已完成2.2.2节的"手动描述"部分和2.2.4节的"开始分析"按钮。
4.  [x] **实现流式结果展示**: 分析完成后，在右侧区域以Tab页流式展示"需求分析"和"模型搜索"的结果，优化了用户体验。

### Milestone 2: 完善功能

1.  [ ] **实现文档上传功能**: 完成2.2.2节的"文档分析"部分。
2.  [ ] **实现高级选项**: 完成2.2.3节。
3.  [ ] **优化结果展示**: 美化Markdown表格样式，并支持更多报告类型。
4.  [ ] **增加状态和日志显示**: 完成2.3.1节中更详细的日志输出功能。

### Milestone 3: 优化与部署

1.  [ ] **打包下载功能**: 实现结果文件夹的zip打包下载。
2.  [ ] **UI/UX 优化**: 根据用户反馈进行微调。
3.  [ ] **编写部署文档**: 提供如何在服务器上部署该WebUI的说明。
